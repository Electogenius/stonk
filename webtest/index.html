<script src="https://cdnjs.cloudflare.com/ajax/libs/rainbow/1.2.0/js/rainbow.min.js"
	referrerpolicy="no-referrer"></script>
<iframe src="em.html" frameborder="0" id=frame></iframe>
<script src="hl.js"></script>
<title>Stonk online editor!</title>
<script src="https://cdn.jsdelivr.net/gh/Electogenius/ledit@main/ledit.js"></script>
<style>
	body {
		background-color: #222;
		color: white;
		--theme: #05d
	}

	textareakinda,
	.leditthing {
		position: absolute;
		resize: none;
		top: 0;
		left: 0;
		width: 100vw;
		height: 50vh;
		padding: 5px;
		margin: 0px;
	}

	button {
		position: absolute;
		top: 5;
		right: 5;
		z-index: 50;
		padding: 10px;
		background: var(--theme);
		font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
		border-radius: 5px;
		border: none;
		color: #fff;
		opacity: 0.9;
	}

	button:active {
		opacity: 1.0;
	}

	iframe {
		position: absolute;
		bottom: 0;
		left: 0;
		width: 100%;
		height: 40vh
	}

	.leditthing {
		color: #6a9955 !important;
	}
</style>
<button onclick="
frame.contentWindow.location=frame.contentWindow.location.href
setTimeout(()=>{

	let doc = frame.contentWindow.document;
		window.total = 0
		doc.querySelectorAll('body *:not(textarea)').forEach(e => e.style.opacity = '0')
		doc.querySelector('textarea').style = 'position:absolute;top:0;left:0;width:100%;height:100%;'
		doc.querySelector('textarea').style.opacity = '1'
		frame.contentWindow.eval(`window.stonk=cwrap('runCode',null,['string'])`)

frame.contentWindow.document.querySelector('textarea').value=''
var ta=frame.contentWindow.document.querySelector('textarea')
frame.contentWindow.stonk(e.textarea.innerText)
ta.value=ta.value.slice(total)
console.log(total)
window.total+=ta.value.length
},500)
">run</button>
<script>
	var e = new Ledit.or({
		language: 'stonk', height: innerHeight / 2, width: innerWidth,
		value: "@main 'hi puts;"
	});
	e.start()
	e.textarea.style.top = e.overlay.style.top = '5'
	e.overlay.style.position = 'absolute'
	e.overlay.style.width = '95%'
	setTimeout(() => {
		let doc = frame.contentWindow.document;
		window.total = 0
		doc.querySelectorAll("body *:not(textarea)").forEach(e => e.style.opacity = '0')
		doc.querySelector("textarea").style = 'position:absolute;top:0;left:0;width:100%;height:100%;'
		doc.querySelector("textarea").style.opacity = '1'
		frame.contentWindow.eval("window.stonk=cwrap('runCode',null,['string'])")
	}, 500)
</script>